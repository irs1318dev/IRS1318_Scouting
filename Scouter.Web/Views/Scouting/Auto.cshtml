@model Scouter.Web.ViewModels.ScoutViewModel

@{
    ViewBag.Title = "Autonomous Scouter: " + Model.Scouter_Id;
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@section scripts{
    <script>

        var robotEvents = @Model.RobotEventTypes;

		$(function ()
		{   
			var Scout = function()
			{
                //var self = self;
				self.color = ko.observable(@Model.Color);
				self.matchID = ko.observable(@Model.Match.Id);
				self.matchNumber = ko.observable(@Model.Match.SequenceNumber);
				self.teamID = ko.observable(@Model.Team.Id);
				self.teamName = ko.observable("@Model.Team.Name");
				self.teamNumber = ko.observable(@Model.Team.Number);
				self.scoutID = ko.observable(@Model.Scouter_Id);
			}

		    var Event = function ()
			{
				self.id = 0;
				self.scouter_Id = 0;
				self.robotMode = 0;
				self.robotEventType = 0;
		    }

			var ScoutInfo = function()
			{
				self.scouter = 0;
				self.match_Id = 0;
				self.scouterStatus = 0;
				self.team_Id = 0;
			}

			var ScoutNotes = function()
			{
				self.Notes = notes.value;
				self.Team_Id = vm.model.teamID;
				self.Match_Id = vm.model.matchID;
				self.Mode = 1;
			}
            //
            // CLIENT SIDE VIEWMODEL
            //
            var ViewModel = function (scout)
            {
                var self = self;
                self.model = scout;

                //Add isClicked Booleans here/////////////////////////////////////////////////////////////////////////////////////////////////////////////
                self.TotesStackedClicked = ko.observable(false);
                self.RightToteMovedClicked = ko.observable(false);
                self.CenterToteMovedClicked = ko.observable(false);
                self.LeftToteMovedClicked = ko.observable(false);
                self.YellowTotesMovedToStepClicked = ko.observable(false);

                self.ContainersFromStepClicked = ko.observable(false);
                self.RightContainerMovedClicked = ko.observable(false);
                self.CenterContainerMovedClicked = ko.observable(false);
                self.LeftContainerMovedClicked = ko.observable(false);
                
                self.AutonomousMovedClicked = ko.observable(false); //checkbox
                self.NoAutonomousClicked = ko.observable(false); //checkbox
                self.AutoAttemptClutterClicked = ko.observable(false); //checkbox
                self.AutoFoulClicked = ko.observable(false);

                //Add Count integers here/////////////////////////////////////////////////////////////////////////////////////////////////////////////////
            	self.TotesStackedCount = ko.observable(0);
            	self.RightToteMovedCount = ko.observable(0);
            	self.CenterToteMovedCount = ko.observable(0);
            	self.LeftToteMovedCount = ko.observable(0);
            	self.YellowTotesMovedToStepCount = ko.observable(0);

            	self.ContainersFromStepCount = ko.observable(0);
            	self.RightContainerMovedCount = ko.observable(0);
            	self.CenterContainerMovedCount = ko.observable(0);
            	self.LeftContainerMovedCount = ko.observable(0);

            	self.AutonomousMovedCount = ko.observable(false); 
            	self.NoAutonomousCount = ko.observable(false); 
            	self.AutoAttemptClutterCount = ko.observable(false); 
            	self.AutoFoulCount = ko.observable(0);

            	self.clear = function()
            	{
                    //Set all isClickd booleans to false here/////////////////////////////////////////////////////////////////////////////////////////////
            	    self.TotesStackedClicked(false);
            	    self.RightToteMovedClicked(false);
            	    self.CenterToteMovedClicked(false);
            	    self.LeftToteMovedClicked(false);
            	    self.YellowTotesMovedToStepClicked(false);

            	    self.ContainersFromStepClicked(false);
            	    self.RightContainerMovedClicked(false);
            	    self.CenterContainerMovedClicked(false);
            	    self.LeftContainerMovedClicked(false);
                    
            	    self.AutonomousMovedClicked(false); 
            	    self.NoAutonomousClicked(false); 
            	    self.AutoAttemptClutterClicked(false); 
            	    self.AutoFoulClicked(false);
            	}

                //Add on clicked functions here///////////////////////////////////////////////////////////////////////////////////////////////////////////
            	function abstractButtonFunction(clicked, count, robotEv)
            	{
            	    //reset all buttons to original color and then set self button to clicked color
            	    self.clear(); 

            	    clicked(true);
            	    //add one to the count of clicks

            	    if (typeof(count()) == Number) {
            	        count(count() + 1);
            	    }
            	    else if (typeof(count()) == Boolean) {
            	        count(!count());
            	    }
            	    else {
                        // terrible 
                    }

            	    //Create a new robot event and set it's variables
            	    var e = new Event(); 
            	    e.scouter_Id = self.model.ScoutID;
            	    e.robotMode = 1;
            	    e.robotEventType = robotEv;
            	    //Send the robot event to the server
            	    scouterDataService.save(ko.toJS(e));
            	}
            	self.TotesStacked() = abstractButtonFunction(self.TotesStackedClicked, self.TotesStackedCount, robotEventTypes["TotesStacked"]);
            	self.ContainersFromStep() = abstractButtonFunction(self.ContainersFromStepClicked, self.ContainersFromStepCount, 6);
            	self.RightContainerMoved() = abstractButtonFunction(self.RightContainerMovedClicked, self.RightContainerMovedCount, 8);
            	self.CenterContainerMoved() = abstractButtonFunction(self.CenterContainerMovedClicked, self.CenterContainerMovedCount, 9);
            	self.LeftContainerMoved() = abstractButtonFunction(self.LeftContainerMovedClicked, self.LeftContainerMovedCount, 10);
            	self.AutoFoul() = abstractButtonFunction(self.AutoFoulClicked, self.AutoFoulCount, 14);

                //don't have parens
            	self.AutonomousMoved = abstractButtonFunction(self.AutonomousMovedClicked, self.AutonomousMovedCount, 11);
            	self.NoAutonomous = abstractButtonFunction(self.NoAutonomousClicked, self.NoAutonomousCount, 12);
            	self.AutoAttemptClutter = abstractButtonFunction(self.AutoAttemptClutterClicked, self.AutoAttemptClutterCount, 13);
            	
                //self.TotesStacked = function()
            	//{
            	//    self.resetButtonClicked();
            	//    self.TotesStackedClicked(true);
            	//    vm.TotesStackedCount(vm.TotesStackedCount() + 1);
            	//    var e = new Event();
            	//    e.scouter_Id = self.model.ScoutID;
            	//    e.robotMode = 1;
            	//    e.robotEventType = 1;
            	//    scouterDataService.save(ko.toJS(e));
            	//}
                
            	self.RightToteMoved
            	{
            	    self.resetButtonClicked();
            	    self. Clicked(true);
            	    vm.RightToteMovedCount(vm.RightToteMovedCount() + 1);
            	    var e = new Event();
            	    e.scouter_Id = self.model.ScoutID;
            	    e.robotMode = 1;
            	    e.robotEventType = 2;
            	    scouterDataService.save(ko.toJS(e));
            	}
            	self.CenterToteMoved
            	{
            	    self.resetButtonClicked();
            	    self.CenterToteMovedClicked(true);
            	    vm.CenterToteMovedCount(vm.CenterToteMovedCount() + 1);
            	    var e = new Event();
            	    e.scouter_Id = self.model.ScoutID;
            	    e.robotMode = 1;
            	    e.robotEventType = 3;
            	    scouterDataService.save(ko.toJS(e));
            	}
            	self.LeftToteMoved
            	{
            	    self.resetButtonClicked();
            	    self.LeftToteMovedClicked(true);
            	    vm.LeftToteMovedCount(vm.LeftToteMovedCount() + 1);
            	    var e = new Event();
            	    e.scouter_Id = self.model.ScoutID;
            	    e.robotMode = 1;
            	    e.robotEventType = 4;
            	    scouterDataService.save(ko.toJS(e));
            	}
            	self.YellowTotesMovedToStep
            	{
            	    self.resetButtonClicked();
            	    self.YellowTotesMovedToStepClicked(true);
            	    vm.YellowTotesMovedToStepCount(vm.YellowTotesMovedToStepCount() + 1);
            	    var e = new Event();
            	    e.scouter_Id = self.model.ScoutID;
            	    e.robotMode = 1;
            	    e.robotEventType = 5;
            	    scouterDataService.save(ko.toJS(e));
            	}



            	self.updateCounter = function()
            	{
            		scouterDataService.updateCounter(@Model.Scouter_Id).done(function (data)
            		{
                        //set your counts to the server counts////////////////////////////////////////////////////////////////////////////////////////////
            		    self.TotesStackedCount(data.TotesStackedCount);
            		    self.RightToteMovedCount(data.RightToteMovedCount);
            		    self.CenterToteMovedCount(data.CenterToteMovedCount);
            		    self.LeftToteMovedCount(data.LeftToteMovedCount);
            		    self.YellowTotesMovedToStepCount(data.YellowTotesMovedToStepCount);
                        
            		    self.ContainersFromStepCount(data.ContainersFromStepCount);
            		    self.RightContainerMovedCount(data.RightContainerMovedCount);
            		    self.CenterContainerMovedCount(data.CenterContainerMovedCount);
            		    self.LeftContainerMovedCount(data.LeftContainerMovedCount);
                        
            		    self.AutonomousMovedCount(data.AutonomousMovedCount);
            		    self.NoAutonomousCount(data.NoAutonomousCount);
            		    self.AutoAttemptClutterCount(data.AutoAttemptClutterCount);
            		    self.AutoFoulCount(data.AutoFoulCount);
            		})
            	}

            	self.nav = function ()
            	{
            		document.location = '/Scouting/Teleop/@Model.Scouter_Id';
            	}

                //set the colors for the buttons
            	if (self.model.scoutID() < 4)//red scouts
            	{
            		self.color = 'red';
            		self.clickColor = 'pink';
            		self.colorAlt = '#FF4444';
            	}
            	else//blue scouts
            	{
            		self.color = 'deepskyblue';
            		self.clickColor = 'lightblue';
            		self.colorAlt = 'skyblue';
            	}

                //tell the server that you are in autonomous
            	var d = new ScoutInfo();
            	d.scouter = self.model.scoutID;
            	d.scouterStatus = 1;
            	d.match_Id = self.model.matchID;
            	d.team_Id = self.model.teamID;

            	scouterDataService.updateScoutData(ko.toJS(d)).done(function (data)
            	{
            		self.updateCounter();
            	});
            	
            }

            //create the viewmodel and apply bindings
            var vm = new ViewModel(new Scout());
            ko.applyBindings(vm);
        })
    </script>
}

<div class="row">
<span style="color:red">Autonomous</span> <span style="font-size:16px" data-bind="text: ' Match: ' + model.matchNumber() + ' Team: ' + model.teamNumber() + ' ('+ model.teamName() + ')'"/>
</div>

<div class="row">
    Totes
</div>
<div class="row">
    <!-- self is where you should create the buttons for the row. the color should either be color or colorAlt(or any other colors you define)
         the class that I was using for the "small" buttons was col-xs-2 and col-xs-4 for the longer ones. One limitation of Bootstraps
         tables is that the rows can have a max of 12 columns -->

    <!-- data-bind="click: <your onClickeFunction>, style: {backgroundColor: <your isClickedBoolean>() ? clickColor : [color | colorAlt]} class="col-xs-2"-->
    <div style="border-style: solid; border-width: medium; border-color: white" data-bind="click: TotesStacked, style: {backgroundColor: TotesStacked() ? clickColor : color}" class="col-xs-2">
        <br />
        <br />
        <!--  Labels! -->
        <span># Stacked</span>
        <br />
        <!--  data-bind="text: <Your countvariable>()" -->
        <span data-bind="text: TotesStackedCount()"></span>
        <br />
        <br />
    </div>
    <div style="border-style: solid; border-width: medium; border-color: white" data-bind="click: RightToteMoved, style: {backgroundColor: RightToteMovedClicked() ? clickColor : colorAlt}" class="col-xs-2">
        <br />
        <br />
        <span>Right Moved</span>
        <br />
        <span data-bind="text: RightToteMovedCount()"></span>
        <br />
        <br />
    </div>
    <div style="border-style: solid; border-width: medium; border-color: white" data-bind="click: CenterToteMoved, style: {backgroundColor: CenterToteMovedClicked() ? clickColor : color}" class="col-xs-2">
        <br />
        <br />
        <span>Center Moved</span>
        <br />
        <span data-bind="text: CenterToteMovedCount()"></span>
        <br />
        <br />
    </div>
    <div style="border-style: solid; border-width: medium; border-color: white" data-bind="click: LeftToteMoved, style: {backgroundColor: LeftToteMovedClicked() ? clickColor : colorAlt}" class="col-xs-2">
        <br />
        <br />
        <span>Left Moved</span>
        <br />
        <span data-bind="text: LeftToteMovedCount()"></span>
        <br />
        <br />
    </div>
    <div style="border-style: solid; border-width: medium; border-color: white" data-bind="click: YellowTotesMovedToStep, style: {backgroundColor: YellowTotesMovedToStepClicked() ? clickColor : color}" class="col-xs-2">
        <br />
        <br />
        <span>Yellow Moved to Step</span>
        <br />
        <span data-bind="text: YellowTotesMovedToStepCount()"></span>
        <br />
        <br />
    </div>
</div>
<div class="row">
    Recycling Containers
</div>
<div class="row">
    <div style="border-style: solid; border-width: medium; border-color: white" data-bind="click: ContainersFromStep, style: {backgroundColor: ContainersFromStepClicked() ? clickColor : colorAlt}" class="col-xs-2">
        <br />
        <br />
        <span>Taken from Step</span>
        <br />
        <span data-bind="text: ContainersFromStepCount()"></span>
        <br />
        <br />
    </div>
    <div style="border-style: solid; border-width: medium; border-color: white" data-bind="click: RightContainerMoved, style: {backgroundColor: RightContainerMovedClicked() ? clickColor : color}" class="col-xs-2">
        <br />
        <br />
        <span>Right Moved</span>
        <br />
        <span data-bind="text: RightContainerMovedCount()"></span>
        <br />
        <br />
    </div>
    <div style="border-style: solid; border-width: medium; border-color: white" data-bind="click: CenterContainerMoved, style: {backgroundColor: CenterContainerMovedClicked() ? clickColor : colorAlt}" class="col-xs-2">
        <br />
        <br />
        <span>Center Moved</span>
        <br />
        <span data-bind="text: CenterContainerMovedCount()"></span>
        <br />
        <br />
    </div>
    <div style="border-style: solid; border-width: medium; border-color: white" data-bind="click: LeftContainerMoved, style: {backgroundColor: LeftContainerMovedClicked() ? clickColor : color}" class="col-xs-2">
        <br />
        <br />
        <span>Left Moved</span>
        <br />
        <span data-bind="text: LeftContainerMovedCount()"></span>
        <br />
        <br />
    </div>
</div>
<div class="row">
    At end of Autonomous...
</div>
<div class="row">
    @*AutoMoved, NoAuto, and ResultCLutter needs to be checkboxes - Count() should be Boolean with TEXT EDITING*@
    <div style="border-style: solid; border-width: medium; border-color: white" data-bind="click: AutonomousMoved, style: {backgroundColor: AutonomousMovedCount() ? clickColor : color}" class="col-xs-2">
        <br />
        <br />
        <span>Robot in AutoZone</span>
        <br />
        <span data-bind="text: AutonomousMovedCount()"></span>
        <br />
        <br />
    </div>
    <div style="border-style: solid; border-width: medium; border-color: white" data-bind="click: NoAutonomous, style: {backgroundColor: NoAutonomousCount() ? clickColor : colorAlt}" class="col-xs-2">
        <br />
        <br />
        <span>No Autonomous</span>
        <br />
        <span data-bind="text: NoAutonomousCount()"></span>
        <br />
        <br />
    </div>
    <div style="border-style: solid; border-width: medium; border-color: white" data-bind="click: AutoResultClutter, style: {backgroundColor: AutoResultClutterCount() ? clickColor : color}" class="col-xs-2">
        <br />
        <br />
        <span>Excess Clutter Result</span>
        <br />
        <span data-bind="text: AutoResultClutterCount()"></span>
        <br />
        <br />
    </div>
    <div style="border-style: solid; border-width: medium; border-color: white" data-bind="click: AutoFoul, style: {backgroundColor: AutoFoulClicked() ? clickColor : colorAlt}" class="col-xs-2">
        <br />
        <br />
        <span>Autonomous Fouls</span>
        <br />
        <span data-bind="text: AutoFoulCount()"></span>
        <br />
        <br />
    </div>
</div>
<div class="row">
	<div data-bind="click: nav, style: {backgroundColor: color}" class="col-xs-2">
		<br />
		<br />
		<span>Teleop</span>
		<br />
		<br />
		<br />
	</div>
</div>